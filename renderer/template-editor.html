<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template Editor - Card Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Using a simple textarea for HTML editing instead of TinyMCE to avoid API key requirements -->
  <style>
        .template-card {
            transition: all 0.3s ease;
        }
        .template-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .template-preview {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            background: #f8f9fa;
        }
        .card-type-badge {
            font-size: 0.8em;
        }
        .template-status {
            font-size: 0.9em;
            color: #6c757d;
    } 
  </style>
</head>
<body>
    <div class="container-fluid">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center">
                    <h1><i class="fas fa-edit me-2"></i>Template Editor</h1>
                    <div>
                        <a href="index.html" class="btn btn-outline-secondary me-2">
                            <i class="fas fa-arrow-left me-2"></i>Back to Main
                        </a>
                        <button class="btn btn-primary" onclick="saveCurrentTemplate()">
                            <i class="fas fa-save me-2"></i>Save Template
                        </button>
                    </div>
                </div>
                <p class="text-muted">Edit and manage card templates. Reference templates provide examples with real data, while custom templates can be edited and saved.</p>
                <div class="alert alert-info" role="alert">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Template Types:</strong> Reference templates show real data examples for visualization. Master templates contain placeholders for dynamic card generation. Both are protected and cannot be modified. Custom templates can be created and edited freely.
                </div>
            </div>
        </div>

        <!-- Template Selection -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-list me-2"></i>Card Types</h5>
                    </div>
                    <div class="card-body">
                        <div class="list-group" id="cardTypeList">
                            <!-- Card types will be populated here -->
                        </div>
                    </div>
      </div>
    </div>
            
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-copy me-2"></i>Templates</h5>
                    </div>
      <div class="card-body">
                        <div class="list-group" id="templateList">
                            <!-- Templates will be populated here -->
                        </div>
                    </div>
          </div>
          </div>
            
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-eye me-2"></i>Preview</h5>
          </div>
                    <div class="card-body">
                        <div id="templatePreview" class="template-preview">
                            <p class="text-muted">Select a template to preview</p>
          </div>
          </div>
          </div>
          </div>
        </div>

        <!-- Editor Section -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fas fa-edit me-2"></i>Template Editor</h5>
        <div>
                                                        <button class="btn btn-outline-info btn-sm me-2" onclick="showPlaceholders()" data-bs-toggle="tooltip" title="View available placeholders for template editing">
                            <i class="fas fa-info-circle me-1"></i>Show Placeholders
                        </button>
                        <button class="btn btn-outline-warning btn-sm me-2" onclick="resetToReference()" data-bs-toggle="tooltip" title="Reset current template to the original reference version">
                            <i class="fas fa-undo me-1"></i>Reset to Reference
                        </button>
                        <button class="btn btn-success btn-sm" onclick="saveTemplate()" data-bs-toggle="tooltip" title="Save current template as a custom template (will prompt if overwriting)">
                            <i class="fas fa-save me-1"></i>Save as Custom
                        </button>
                        <button class="btn btn-outline-secondary btn-sm ms-2" onclick="showHelp()" data-bs-toggle="tooltip" title="View detailed help and instructions">
                            <i class="fas fa-question-circle me-1"></i>Help
                        </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="editorContainer">
                            <textarea id="templateEditor"></textarea>
                        </div>
                        <div class="mt-3">
                            <small class="text-muted">
                                <strong>Available Placeholders:</strong> {title}, {subtitle}, {content}, {imageUrl}, {price}, {filename}
                            </small>
                        </div>
                    </div>
                </div>
        </div>
      </div>
    </div>

    <!-- Placeholders Modal -->
    <div class="modal fade" id="placeholdersModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-info-circle me-2"></i>Template Placeholders</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Placeholder</th>
                                    <th>Description</th>
                                    <th>Example</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>{title}</code></td>
                                    <td>Card title</td>
                                    <td>"Double child seat"</td>
                                </tr>
                                <tr>
                                    <td><code>{subtitle}</code></td>
                                    <td>Card subtitle or price</td>
                                    <td>"£187.00"</td>
                                </tr>
                                <tr>
                                    <td><code>{content}</code></td>
                                    <td>Card description</td>
                                    <td>"The double child seat with..."</td>
                                </tr>
                                <tr>
                                    <td><code>{imageUrl}</code></td>
                                    <td>Image URL</td>
                                    <td>"https://cdn11.bigcommerce.com/..."</td>
                                </tr>
                                <tr>
                                    <td><code>{price}</code></td>
                                    <td>Price value</td>
                                    <td>"£187.00"</td>
                                </tr>
                                <tr>
                                    <td><code>{filename}</code></td>
                                    <td>Image filename</td>
                                    <td>"70-18-detail.jpg"</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div class="modal fade" id="helpModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-question-circle me-2"></i>Template Editor Help</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6><i class="fas fa-shield-alt text-success me-2"></i>Safety Features</h6>
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success me-2"></i><strong>Reference Templates:</strong> Protected - cannot be modified or overwritten</li>
                                <li><i class="fas fa-check text-success me-2"></i><strong>Master Templates:</strong> Protected - cannot be modified or overwritten</li>
                                <li><i class="fas fa-check text-success me-2"></i><strong>Custom Templates:</strong> Safe to edit - you'll be prompted before overwriting</li>
                            </ul>
                            
                            <h6 class="mt-4"><i class="fas fa-edit text-primary me-2"></i>How to Edit Templates</h6>
                            <ol>
                                <li>Select a card type from the left panel</li>
                                <li>Choose a template to edit (Reference, Master, or Custom)</li>
                                <li>Edit the HTML in the textarea editor</li>
                                <li>Use placeholders like <code>{title}</code>, <code>{content}</code> for dynamic content</li>
                                <li>Preview your changes in real-time</li>
                                <li>Save as a custom template when ready</li>
                            </ol>
                        </div>
                        
                        <div class="col-md-6">
                            <h6><i class="fas fa-info-circle text-info me-2"></i>Template Types</h6>
                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title"><span class="badge bg-info">Reference</span> Templates</h6>
                                    <p class="card-text">Templates with real data examples for visualization. Used to see how cards will look with actual content. Cannot be modified.</p>
    </div>
  </div>

                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title"><span class="badge bg-primary">Master</span> Templates</h6>
                                    <p class="card-text">Templates with placeholders for dynamic card generation. These are used to create actual cards with real data. Cannot be modified.</p>
    </div>
  </div>

                            <div class="card mb-3">
                                <div class="card-body">
                                    <h6 class="card-title"><span class="badge bg-success">Custom</span> Templates</h6>
                                    <p class="card-text">Your own templates that you can create, edit, and save. These can have either real data or placeholders. Safe to modify.</p>
    </div>
  </div>

                            <h6 class="mt-4"><i class="fas fa-exclamation-triangle text-warning me-2"></i>Important Notes</h6>
                            <ul>
                                <li>Always test your templates before using them in production</li>
                                <li>Use the preview to see how your template will look with real data</li>
                                <li>Custom templates are saved in the <code>templates/custom/</code> directory</li>
                                <li>You can always reset to the reference template if needed</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="template-editor.js"></script>
</body>
</html> 